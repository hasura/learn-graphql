(this["webpackJsonpreact-apollo-todo"]=this["webpackJsonpreact-apollo-todo"]||[]).push([[0],{96:function(e,t,c){},97:function(e,t,c){"use strict";c.r(t),c.d(t,"history",(function(){return Z}));var n,i,s=c(26),r=c.n(s),a=c(0),l=c.n(a),o=c(55),d=c(18),j=c(11),u=c(31),b="graphql-tutorials.auth0.com",O="P38qnFo1lFAQJrzkun--wEzqljVNGcWW",h="hasura",m="openid profile email",x=c(2),p=function(e){var t=e.children,c=Object(j.d)();return Object(x.jsx)(u.a,{domain:b,clientId:O,redirectUri:window.location.origin,onRedirectCallback:function(e){c.push((null===e||void 0===e?void 0:e.returnTo)||window.location.pathname)},audience:h,scope:m,children:t})},v=c(15),f=c(107),g=c(113),N=function(e){var t=e.logoutHandler;return Object(x.jsx)(g.a,{id:"qsLogoutBtn",variant:"primary",className:"btn-margin logoutBtn",onClick:t,children:"Log Out"})},_=function(e){var t=e.logoutHandler;return Object(x.jsxs)(f.a,{className:"justify-content-between",children:[Object(x.jsx)(f.a.Brand,{children:"GraphQL Tutorial App"}),Object(x.jsx)(f.a.Collapse,{className:"justify-content-end",children:Object(x.jsx)(N,{logoutHandler:t})})]})},C=function(){var e=Object(u.b)(),t=e.loading,c=e.loginWithRedirect;return t?Object(x.jsx)("div",{children:"Loading..."}):Object(x.jsx)("div",{className:"overlay",children:Object(x.jsxs)("div",{className:"overlay-content",children:[Object(x.jsx)("div",{className:"overlay-heading",children:"Welcome to the GraphQL tutorial app"}),Object(x.jsx)("div",{className:"overlay-message",children:"Please login to continue"}),Object(x.jsx)("div",{className:"overlay-action",children:Object(x.jsx)(g.a,{id:"qsLoginBtn",variant:"primary",className:"btn-margin loginBtn",onClick:function(){c({})},children:"Log In"})})]})})},k=c(49),w=c(44),y=c(110),T=c(114),P=c(4),S=c(112),L=function(e){e.index;var t=e.todo;return Object(x.jsxs)("li",{children:[Object(x.jsx)("div",{className:"view",children:Object(x.jsxs)("div",{className:"round",children:[Object(x.jsx)("input",{checked:t.is_completed,type:"checkbox",id:t.id,onChange:function(){}}),Object(x.jsx)("label",{htmlFor:t.id})]})}),Object(x.jsx)("div",{className:"labelContent"+(t.is_completed?" completed":""),children:Object(x.jsx)("div",{children:t.title})}),Object(x.jsx)("button",{className:"closeBtn",onClick:function(e){e.preventDefault(),e.stopPropagation()},children:"x"})]})},A=function(e){var t=e.todos,c=e.currentFilter,n=e.filterResultsFn,i=e.clearCompletedFn,s=function(e){return function(){n(e)}},r=Object(x.jsx)("button",{onClick:i,className:"clearComp",children:"Clear completed"}),a=t.filter((function(e){return!0!==e.is_completed})),l=t.length;return"active"===c?l=a.length:"completed"===c&&(l=t.length-a.length),Object(x.jsxs)("div",{className:"footerList",children:[Object(x.jsxs)("span",{children:[" ",l," item",1!==l?"s":""]}),Object(x.jsxs)("ul",{children:[Object(x.jsx)("li",{onClick:s("all"),children:Object(x.jsx)("a",{className:"all"===c?"selected":"",children:"All"})}),Object(x.jsx)("li",{onClick:s("active"),children:Object(x.jsx)("a",{className:"active"===c?"selected":"",children:"Active"})}),Object(x.jsx)("li",{onClick:s("completed"),children:Object(x.jsx)("a",{className:"completed"===c?"selected":"",children:"Completed"})})]}),r]})},E=Object(y.a)(n||(n=Object(w.a)(["\n  query getMyTodos {\n    todos(where: { is_public: { _eq: false} }, order_by: { created_at: desc }) {\n      id\n      title\n      created_at\n      is_completed\n  }\n }"]))),F=function(e){var t=Object(a.useState)({filter:"all",clearInProgress:!1}),c=Object(v.a)(t,2),n=c[0],i=c[1],s=e.todos,r=s;"active"===n.filter?r=s.filter((function(e){return!0!==e.is_completed})):"completed"===n.filter&&(r=s.filter((function(e){return!0===e.is_completed})));var l=[];return r.forEach((function(e,t){l.push(Object(x.jsx)(L,{index:t,todo:e},t))})),Object(x.jsxs)(a.Fragment,{children:[Object(x.jsx)("div",{className:"todoListWrapper",children:Object(x.jsx)("ul",{children:l})}),Object(x.jsx)(A,{todos:r,currentFilter:n.filter,filterResultsFn:function(e){i(Object(P.a)(Object(P.a)({},n),{},{filter:e}))},clearCompletedFn:function(){},clearInProgress:n.clearInProgress})]})},W=function(){var e=Object(S.a)(E),t=e.loading,c=e.error,n=e.data;return t?Object(x.jsx)("div",{children:"Loading..."}):c?(console.error(c),Object(x.jsx)("div",{children:"Error!"})):Object(x.jsx)(F,{todos:n.todos})},H=Object(y.a)(i||(i=Object(w.a)(["\n mutation ($todo: String!, $isPublic: Boolean!) {\n   insert_todos(objects: {title: $todo, is_public: $isPublic}) {\n     affected_rows\n     returning {\n       id\n       title\n       created_at\n       is_completed\n     }\n   }\n }\n"]))),I=function(e){var t=e.isPublic,c=void 0!==t&&t,n=Object(a.useState)(""),i=Object(v.a)(n,2),s=i[0],r=i[1],l=Object(T.a)(H,{update:function(e,t){var n=t.data;if(c)return null;var i=e.readQuery({query:E}),s=n.insert_todos.returning[0];e.writeQuery({query:E,data:{todos:[s].concat(Object(k.a)(i.todos))}})},onCompleted:function(){r("")}}),o=Object(v.a)(l,1)[0];return Object(x.jsxs)("form",{className:"formInput",onSubmit:function(e){e.preventDefault(),o({variables:{todo:s,isPublic:c}})},children:[Object(x.jsx)("input",{className:"input",placeholder:"What needs to be done?",value:s,onChange:function(e){return r(e.target.value)}}),Object(x.jsx)("i",{className:"inputMarker fa fa-angle-right"})]})},U=function(){return Object(x.jsxs)("div",{className:"todoWrapper",children:[Object(x.jsx)("div",{className:"sectionHeader",children:"Personal todos"}),Object(x.jsx)(I,{}),Object(x.jsx)(W,{})]})},q=function(e){e.index;var t=e.todo;return Object(x.jsxs)("li",{children:[Object(x.jsxs)("div",{className:"userInfoPublic",title:t.user.name,children:["@",t.user.name]}),Object(x.jsx)("div",{className:"labelContent"+(t.is_completed?" completed":""),children:Object(x.jsx)("div",{children:t.title})})]})},B=function(e){var t={olderTodosAvailable:!0,newTodosCount:1,todos:[{id:"1",title:"This is public todo 1",user:{name:"someUser1"}},{id:"2",title:"This is public todo 2",is_completed:!1,is_public:!0,user:{name:"someUser2"}},{id:"3",title:"This is public todo 3",user:{name:"someUser3"}},{id:"4",title:"This is public todo 4",user:{name:"someUser4"}}]},c=t.todos,n=Object(x.jsx)("ul",{children:c.map((function(e,t){return Object(x.jsx)(q,{index:t,todo:e},t)}))}),i="";t.newTodosCount&&(i=Object(x.jsxs)("div",{className:"loadMoreSection",onClick:function(){},children:["New tasks have arrived! (",t.newTodosCount.toString(),")"]}));var s=Object(x.jsx)("div",{className:"loadMoreSection",onClick:function(){},children:t.olderTodosAvailable?"Load older tasks":"No more public tasks!"});return Object(x.jsx)(a.Fragment,{children:Object(x.jsxs)("div",{className:"todoListWrapper",children:[i,n,s]})})},R=function(){return Object(x.jsxs)("div",{className:"todoWrapper",children:[Object(x.jsx)("div",{className:"sectionHeader",children:"Public feed (realtime)"}),Object(x.jsx)(I,{isPublic:!0}),Object(x.jsx)(B,{})]})},M=function(e){var t=e.user;return Object(x.jsxs)("div",{className:"userInfo",children:[Object(x.jsx)("div",{className:"userImg",children:Object(x.jsx)("i",{className:"far fa-user"})}),Object(x.jsx)("div",{className:"userName",children:t.name})]})},D=function(){var e=[{name:"someUser1"},{name:"someUser2"}],t=[];return e.forEach((function(e,c){t.push(Object(x.jsx)(M,{index:c,user:e},c))})),Object(x.jsxs)("div",{className:"onlineUsersWrapper",children:[Object(x.jsxs)("div",{className:"sliderHeader",children:["Online users - ",e.length]}),t]})},Q=c(108),G=c(109),$=c(111),z=c(106),J=c(59),K=c.n(J),V=c(73);var X=function(){var e=Object(a.useState)(null),t=Object(v.a)(e,2),c=t[0],n=t[1],i=Object(u.b)(),s=i.user,r=i.getAccessTokenSilently;return Object(a.useEffect)((function(){var e=function(){var e=Object(V.a)(K.a.mark((function e(){var t,c,i;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=h,c=m,e.prev=1,e.next=4,r({audience:t,scope:c});case 4:i=e.sent,n(i),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}();e()}),[r,null===s||void 0===s?void 0:s.sub]),c},Y=function(){var e=X(),t=Object(u.b)(),c=t.loading,n=t.logout,i=Object(a.useState)(new Q.a({link:new G.a({uri:"https://hasura.io/learn/graphql",headers:{Authorization:"Bearer ".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_AUTH_GRAPHQL)}}),cache:new $.a})),s=Object(v.a)(i,1)[0];return c?Object(x.jsx)("div",{children:"Loading..."}):e?Object(x.jsx)(z.a,{client:s,children:Object(x.jsxs)("div",{children:[Object(x.jsx)(_,{logoutHandler:n}),Object(x.jsxs)("div",{className:"row container-fluid p-left-right-0 m-left-right-0",children:[Object(x.jsxs)("div",{className:"row col-md-9 p-left-right-0 m-left-right-0",children:[Object(x.jsx)("div",{className:"col-md-6 sliderMenu p-30",children:Object(x.jsx)(U,{})}),Object(x.jsx)("div",{className:"col-md-6 sliderMenu p-30 bg-gray border-right",children:Object(x.jsx)(R,{})})]}),Object(x.jsx)("div",{className:"col-md-3 p-left-right-0",children:Object(x.jsx)("div",{className:"col-md-12 sliderMenu p-30 bg-gray",children:Object(x.jsx)(D,{})})})]})]})}):Object(x.jsx)(C,{})},Z=(c(96),Object(d.a)());r.a.render(Object(x.jsx)(l.a.StrictMode,{children:Object(x.jsx)(o.a,{children:Object(x.jsx)(p,{children:Object(x.jsx)(Y,{})})})}),document.getElementById("root"))}},[[97,1,2]]]);
//# sourceMappingURL=main.59b4560b.chunk.js.map